---
layout: post
title: kaggle面部关键点检测
date: 2018-11-17
categories: [torch]
tags: torch
---
<!--more-->

在kaggle上看到了一个关于人脸面部关键点检测的，数据量比较小，就玩儿了一下。感觉结果还不错（还没有发到网上测评，但是感觉还可以，回头有空了再试试其它的结构，也把结果测评一下，这样可以知道好坏。）

网址见于 [link](https://www.kaggle.com/c/facial-keypoints-detection)

然后下面记录一下我玩儿的过程。

* 处理数据，因为下载下来的是.csv文件，所以需要处理一下，做成训练集，（没有做验证集），

* 图像的像素是96×96的，但是只有一个通道，如果想变成3个通道的话，我想到了有三种办法应该可以，第一种是用plt先保存成.jpg的格式，然后再用cv读出来时就是三个通道的了，第二种方式是直接把第一个通道复制到另外两个通道，第三种方式是前面加几个1×1的卷积，输出通道指定为3即可，我觉得第三种方式应该最合适，这里面的参数还可以学习。

* 数据中有15个关键点，我加了一个背景的，当成是16个关键点来做的。

* 一个有些annoying的事情是数据中有些丢失信息，就是并不是每条数据的关键点都15个，有些嘴角在图中没有出现就没有数据，这样的我当成全0处理的。

* 训练过程。刚开始发现发散了，然后把学习率直接降了两个量级，慢慢地收敛，总共训练了80000个iters，每个iter的batch是70。

* 测试过程，测试的时候我也是先把数据从csv转出来，然后再做的。

最终的结果展示几个例子如下。

![avator](/images/20_test.jpg)
![avator](/images/9_test.jpg)
![avator](/images/34_test.jpg)
![avator](/images/41_test.jpg)




